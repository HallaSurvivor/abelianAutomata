\documentclass[12]{article}

\usepackage{amsmath,amsthm,amssymb}

\newcommand{\A}{\mathcal{A}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\P}{\mathfrak{A}}
\newcommand{\C}{\mathfrak{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\2}{\textbf{2}}
\newcommand{\Am}\textbf{A}}
\newcommand{\del}{\partial}
\newcommand{\v}{\bar{v}}

\newtheorem{thm}{Theorem}

\title{Extensions of Abelian Automata Groups}
\author{Chris Grossack}

\begin{document}
\maketitle

\section{Background}
TODO: this whole section

\section{Group Extensions}
Going forward, $\G$ will denote $\G(\P)$ for some principal machine $\P$.

In the case of interest, $\G \cong \Z^m$. Further, $\del_0$ extends to 
a $\frac{1}{2}$-Integral matrix $\Am$ of irreducible character. Then
$\G$ admits representation as a $\Z[x]$ module where 
$x \cdot \v = \Am^{-1}\v$, extended linearly.
Further, since $\Am$ has irreducible character (in $\Z$ and in $\Q$), 
so does $\Am^{-1}$. Thus this module is cyclic, 
and generated by $\bar{e_1} = \delta$.

Clearly $End_{\G}$, the ring of module endomorphisms of $\G$, 
is isomorphic to $\Z[x]/(\chi^*)$, 
where $\chi^*$ is the characteristic polynomial of $\Am^{-1}$.
Now for some $p \in End_{\G}$ we consider
$p \cdot \G = \Z^m$, with $\delta$ at $p \cdot \bar{e_1}$.
This corresponds to using a residuation vector $\bar{e} = p \cdot bar{e_1}$.
(Thus we require $p$ have odd constant term)
For reasons which will soon become clear, we call $p \cdot \G$ the
\textbf{Group Extension} of $\G$ by $p$.

To justify this nomenclature, we first notice 
$\G \hookrightarrow p \cdot \G$ for all $p$ by the
homomorphism $\v \mapsto p \cdot \v$. 
Further, we recognize that if $p$ is not a unit in $End_{\G}$, 
this homomorphism is \emph{not} surjective. 
That is to say $\G$ is a proper subgroup of $p \cdot \G$.
\textbf{Note:} It \emph{is} the case that $\G \cong \Z^m \cong p \cdot \G$. 

Every function $f \in \G$ is also an element of $p \cdot \G$. 
If $f \in \G$ is located at $\v$, then $\f \in p \cdot \G$ is located
at $p \cdot \v$. In fact, this is true in a more general sense:

\begin{thm}
  If $mp = q$, then $p \cdot \G \hookrightarrow q \cdot \G$, 
  with a canonical injection $\phi_m~:~\v \mapsto m \cdot \v$. 
  In particular, if $m$ is a unit, then $p \cdot \G \cong q \cdot \G$.
\end{thm}

\begin{proof}
  Let $mp = q$, $f \in p \cdot \G$ located at $\v$.
  Consider $f' \in q \cdot \G$ located at $m \cdot \v$.

  First note $f$ and $f'$ have the same parity, since 
  $m$ has odd constant term, and so $\v$ and $m \cdot \v$
  have the same parity. Now, consider the residuals of $f$ and $f'$. 
  
  If $f$ is even, then 
  \[ \del_0 f' = \Am (m \cdot \v) = m \cdot \Am \v = m \cdot \del_0 f \]

  If $f$ is odd, then
  \[ \del_0 f' = \Am (m \cdot \v - q \cdot \bar{e_1}) 
               = m \cdot \Am (\v - p \cdot \bar{e_1})
               = m \cdot \del_0 f \]

  A similar argument shows $\del_1 f' = m \cdot \del_1 f$
\end{proof}

\section{Fractional Elements}
So for $p \cdot \G$ we know exactly how vectors of the form $p \cdot \v$
behave as functions: They are exactly the functions present in $\G$.
However there are plenty of vectors which do not have the above form. 
How do they behave? We call such vectors (and their corresponding functions)
\textbf{Fractional}, due to the following observation.

Consider $3 \cdot \G$. What does $\bar{e_1}$ do as a function?
Well, $3\bar{e_1}$ should do the same function as $\delta$, and so
$\bar{e_1}$ should behave like ``$\frac{1}{3}\delta$'', and in fact it does.

In general, $\v \in p \cdot \G$ behaves like $p^{-1} \cdot \v \in \G$,
(where $p^{-1}$ comes from $\Q[x]$ and so $p^{-1} \cdot \v \in \Q^m$)
and so Group Extensions give us access to fractional functions from 
our base group $\G$.

\section{Characterizing Automata}
Every strongly connected automaton $\A$ lives in $p \cdot \G$ where 
$\G$ is the principal group associated to $\A$ and $p$ is a polynomial. 
Further, $\A$ can always be anchored with an odd state at $\bar{e_1}$. 
Thus, the study of Group Extensions is sufficient to study all abelian automata.

\begin{thm}
  Every strongly connected abelian automaton $\A$ can be anchored with an 
  odd state at $\bar{e_1}$ in $p \cdot \G$ as above.
\end{thm}

\begin{proof}
  Let $f$ be an odd state in $\A$. Then $f_0$ and $f_1$ are distinct
  and both have paths to $f$ by strongly connectedness. Thus we have two
  distinct cycles $c_0$ and $c_1$ from $f$ to $f$ in $\A$.
  Each of these cycles gives rise to a matrix equation 
  $\v_f = g_0(\v_f,\bar{e}) = g_1(\v_f,\bar{e})$ corresponding to following
  the path in $\Z^m$ (with unknown residuation vector \bar{e}). 
  Then $(g_0 - g_1)(\v_f, \bar{e}) = \bar{0}$ and we can solve for 
  $\bar{e}$ in terms of $\v_f$.

  Choosing $\v_f = \bar{e_1}$ gives a value for the residuation vector $e$,
  which (by cyclicity) gives a polynomial $p_e$ 
  such that $p_e \cdot \bar{e_1} = e$. Then, by construction, $\A$ is 
  a subautomaton of $p_e \cdot \G$, and is anchored with $f$ at $\bar{e_1}$.
  As desired.
\end{proof}

\section{Characterizing Orbits}

Recall an \textbf{Orbit} of $f \in \G(\A)$ at $u \in \2^{\omega}$
is $\{ f^t u | t \in \Z \}$, or, additively, $\{ tf u | t \in \Z \}$.
It is a reasonable question to wonder what these orbits look like
for an arbitrary automaton?

By the above theorem, it suffices to consider $f \in p \cdot \G$
for some principal group $\G$. Fix such a group.

We begin with a useful lemma

\begin{thm}
  $x^n \cdot \delta (u0v) = u1v$ (where $|u| = n$)
\end{thm}

\begin{proof}
  If $n=0$ the theorem is clear, since 
  $\delta 0v = 1 (\del_0 \delta v) = 1 (I v) = 1v$

  Further by induction, 
  $x^{n+1} \cdot \delta (u_0u0v) = 
  \Am^{-1} (x^n \cdot \delta) (u_0u0v) =
  u_0 (x^n \cdot \delta) (u0v) =
  u_0u1v$
\end{proof}

We will first prove the result in the finite case.

\begin{thm}
  For every word $u \in \2^n$, there exists a unique function
  (mod $Stab(0^n)$) $f$ such that $f 0^n = u$.
\end{thm}

\begin{proof}
  The existance of such a function is a direct consequence of the lemma,
  and is given by $\sum_{i=0}^{n-1} u_i x^i \delta$.
  Uniqueness mod $Stab(0^n)$ is immediate from basic group theory.
\end{proof}

Denote this function by $\langle u \rangle$. 

\begin{thm}
  The orbit of $f$ at $u$ is given by the line $\Zf + \langle u \rangle$
\end{thm}

\begin{proof}
  Let $w = tf u$. Then $\langle w \rangle$ sends $0^n$ to $w$, 
  but so does $tf + \langle u \rangle$. By uniqueness, then,
  $\langle w \rangle = tf + \langle u \rangle$ and the theorem follows.
\end{proof}

Note that this argument works in the infinite case as well, provided 
we have a suitable definition of $\langle u \rangle$ for $u \in \2^\omega$.
For cardinality reasons, we clearly cannot send $0^\omega$ to any $u$.
Below we will characterize exactly those $u$ for which a $\langle u \rangle$
exists.

\begin{thm}
  For $u \in \2^\omega$, $\langle u \rangle$ exists in some group extension
  iff $u$ is ultimately periodic.
\end{thm}

\begin{proof}
  Since every function $f \in p \cdot G$ eventualy residuates into a 
  strongly connected component, $f 0^\omega$ is ultimately periodic for
  every such $f$.

  Further, if we have an ultimately periodic string $u = tv^*$, then
  $\sum_{i=0}^{\infty} u_i x^i \delta$ works if it exists. Further,
  it exists, since:

  \begin{align*}
    \sum_{i=0}^{\infty} u_i x^i \delta 
    &= \sum_{i=0}^{|t|} t_i x^i \delta 
        + \sum_{i=|t|}^{\infty} v^*_i x^i \delta\\
    &= \sum_{i=0}^{|t|} t_i x^i \delta 
        + x^{|t|} \sum_{i=0}^{\infty} v^*_i x^i \delta\\
    &= \sum_{i=0}^{|t|} t_i x^i \delta 
        + x^{|t|} \frac{\sum_{i=0}^{|v|} v^_i x^i \delta}{1 - x^{|v|}}\\
    &= \left ( 
        \sum_{i=0}^{|t|} t_i x^i
        + x^{|t|} \frac{\sum_{i=0}^{|v|} v^_i x^i}{1 - x^{|v|}}
       \right ) \cdot \delta\\
    &= \frac%
        {%
          1 - x^{|v|} \sum_{i=0}^{|t|} t_i x^i + 
          x^{|t|} \sum_{i=0}^{|v|} v^_i x^i
        }
        {1 - x^{|v|}}
       \cdot \delta\\
    &= \frac{q}{1 - x^{|v|}} \cdot \delta
  \end{align*}

  Finally, this sum is convergent in the cantor topology, since 
  for each $N \geq 0$, for all $n \geq N$, the $nth$ partial sums 
  agree on the first $N$ bits of the string.

  Thus, this sum is equal to $q \cdot \delta \in 1 - x^{|v|} \cdot \G$.
\end{proof}

For ultimately periodic strings $u \in \2^\omega$, $f$ orbits
of $u$ correspond to lines $\Zf + \langle u \rangle$.

\end{document}
